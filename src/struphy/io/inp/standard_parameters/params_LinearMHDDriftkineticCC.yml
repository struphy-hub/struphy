grid:
    Nel: [32, 32, 8]
    p: [2, 3, 1]
    spl_kind: [false, true, true]
    dirichlet_bc: null
    dims_mask: [true, true, true]
    nq_el: [2, 2, 1]
    nq_pr: [2, 2, 1]
    polar_ck: -1
    Nclones: 1

units: {x: 1.0, B: 1.0, n: 1.0, kBT: 1.0}

time :
    dt         : 0.05   # time step
    Tend       : 1.0    # simulation time interval is [0, Tend]
    split_algo : LieTrotter # LieTrotter | Strang

geometry :
    type : HollowTorus
    HollowTorus :
        a1  : 0.1   # inner radius
        a2  : 1.    # minor radius
        R0  : 10.   # major radius
        sfl : False # straight field line coordinates?
        tor_period : 6 # toroidal periodicity built into the mapping: phi = 2*pi * eta3 / tor_period

mhd_equilibrium : 
    type : AdhocTorus # (possible choices seen below)
    # ITPA benchmark case
    AdhocTorus :
        a       : 1. # minor radius
        R0      : 10. # major radius
        B0      : 3. # on-axis toroidal magnetic field
        q_kind  : 0 # which profile (0 : parabolic, 1 : other, see documentation)
        q0      : 1.71 # safety factor at r=0
        q1      : 1.87 # safety factor at r=a
        n1      : 0. # shape factor for number density profile 
        n2      : 0. # shape factor for number density profile 
        na      : 1. # number density at r=a
        p_kind  : 1 # kind of pressure profile (0 : cylindrical limit, 1 : ad hoc)
        p1      : 0.95 # shape factor for ad hoc pressure profile
        p2      : 0.05 # shape factor for ad hoc pressure profile
        beta    : .0018 # plasma beta for flat safety factor (ratio of kinetic pressure to magnetic pressure)

electric_equilibrium:
    type: HomogenSlab
    HomogenSlab: {phi0: 1.0}

braginskii_equilibrium:
    type: HomogenSlabITG
    HomogenSlabITG: {}

em_fields:
    background:
        type: LogicalConst
        LogicalConst:
            comps:
                b_field: [0.3, 0.15, null]
    perturbation:
        type: TorusModesCos
        TorusModesCos:
            comps:
                b_field: [null, v, null]
            ms:
                b_field:
                - null
                - [1, 3]
                - null

fluid:
    mhd:
        phys_params: {A: 1, Z: 1}
        background:
            type: LogicalConst
            LogicalConst:
                comps:
                    density: 1.3
                    velocity: [0.3, 0.15, null]
                    pressure: 1.3
        perturbation:
            type: TorusModesCos
            TorusModesCos:
                comps:
                    density: '0'
                    velocity: [null, v, null]
                    pressure: '0'
                ms:
                    density: [1]
                    velocity:
                    - null
                    - [1, 3]
                    - null
                    pressure: [1]
        options:
            CurrentCoupling5DDensity:
                solver:
                    type: [pbicgstab, MassMatrixPreconditioner]
                    tol: 1.0e-08
                    maxiter: 3000
                    info: false
                    verbose: false
                    recycle: true
                turn_off: false
            ShearAlfvenCurrentCoupling5D:
                solver:
                    type: [pcg, MassMatrixPreconditioner]
                    tol: 1.0e-08
                    maxiter: 3000
                    info: false
                    verbose: false
                    recycle: true
                filter:
                    use_filter: null
                    modes: [0, 1]
                    repeat: 3
                    alpha: 0.5
                turn_off: false
            MagnetosonicCurrentCoupling5D:
                solver:
                    type: [pbicgstab, MassMatrixPreconditioner]
                    tol: 1.0e-08
                    maxiter: 3000
                    info: false
                    verbose: false
                    recycle: true
                filter:
                    use_filter: null
                    modes: [0, 1]
                    repeat: 3
                    alpha: 0.5
                turn_off: false
            u_space: Hdiv

kinetic:
    energetic_ions:
        phys_params: {A: 1, Z: 1}
        markers:
            type: full_f
            ppc: null
            Np: 1000
            eps: 10.
            bc:
                type: [periodic, periodic, periodic]
            loading:
                type: pseudo_random
                seed: 1234
                spatial: uniform
                dir_particles: path_to_particles
                moments: [0.0, 0.0, 1.0, 1.0]
        save_data:
            n_markers: 3
            f:
                slices: [e1, e1_e2]
                n_bins:
                - [32]
                - [32, 32]
                ranges:
                -   - [-3.0, 3.0]
                -   - [0.0, 1.0]
                    - [-5.0, 5.0]
        perturbation:
            type: TorusModesCos
            TorusModesCos:
                comps: {n: '0'}
                ms:
                    n: [1]
        options:
            PushGuidingCenterBxEstar:
                algo: {method: discrete_gradient_2nd_order, maxiter: 20, tol: 1.0e-07,
                    mpi_sort: each, verbose: false}
            PushGuidingCenterParallel:
                algo: {method: discrete_gradient_2nd_order, maxiter: 20, tol: 1.0e-07,
                    mpi_sort: each, verbose: false}
            CurrentCoupling5DGradB:
                solver:
                    type: [pcg, MassMatrixPreconditioner]
                    tol: 1.0e-08
                    maxiter: 3000
                    info: false
                    verbose: false
                    recycle: true
                algo: rk4
                filter:
                    use_filter: null
                    modes: [0, 1]
                    repeat: 3
                    alpha: 0.5
                turn_off: false
            CurrentCoupling5DCurlb:
                solver:
                    type: [pcg, MassMatrixPreconditioner]
                    tol: 1.0e-08
                    maxiter: 3000
                    info: false
                    verbose: false
                    recycle: true
                filter:
                    use_filter: null
                    modes: [0, 1]
                    repeat: 3
                    alpha: 0.5
                turn_off: false
        background:
            type: GyroMaxwellian2D
            GyroMaxwellian2D: {n: 0.05}

diagnostics:
    accumulated_magnetization: {save_data: true}
